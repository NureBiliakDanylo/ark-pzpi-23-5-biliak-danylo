МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ
ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ




КАФЕДРА ПРОГРАМНОЇ ІНЖЕНЕРІЇ








Звіт
з лабораторної роботи № 3 з дисципліни
Аналіз та рефакторинг коду
за темою “Програмна система для прогнозування погоди із використанням технологій IoT, веб та мобільних клієнтів”
   










Виконав:                                                                                       Перевірив:
ст. гр. ПЗПІ-23-5                                                        ст. викладач кафедри ПІ
Біляк Данило                                                                 Сокорчук Ігор Петрович












Харків 2025
________________
2 ЗАВДАННЯ
1. Розробити бізнес логіку серверної частини програмної системи.
2. Розробити функції адміністрування серверної частини програмної системи.
3. Створити програмну реалізацію бізнес логіки та функцій адміністрування серверної частини.
4. Перевірити роботу серверної частини системи.
5. Завантажити або оновити (при потребі) створений програмний код у GitHub репозиторій для лабораторних робіт у гілку репозиторію main.
6. Створити відеозапис демонстрації описаної у розділі 3.1 Vision & Scope функціональності серверної частини та завантажити цей відеозапис у свій канал на YouTube для облікового запису в домені @nure.ua.  При завантаженні відеозапису потрібно обовʼязково встановити у налаштуваннях для цього відео українську мову як мову відео та мову субтитрів до відео.
7. Створити хронологічний опис (хвилина:секунда) демонстрації та додати цей опис до опису відео.
8. Створити звіт до лабораторної роботи.
9. Експортувати створений звіт у формат PDF та завантажити його на платформу dl.nure.ua.
10. Експортувати увесь створений звіт у простий текстовий файл з кодуванням UTF-8 та записати цей файл у GitHub репозиторій для лабораторних робіт з вказаним у цих методичних вказівках іменем файла та директорії.
________________


3 ХІД РОБОТИ
3.1 Архітектурні рішення
Архітектура серверної частини системи базується на платформі Node.js та фреймворку Express.js, який використовується для створення REST-орієнтованого API. Вся логіка системи розділена на три чітко визначені функціональні шари:
1.  Шар маршрутизації (Controllers/Routes): Реалізований у файлі “src/index.js”, цей шар обробляє вхідні HTTP-запити від клієнтів (наприклад, запит на отримання прогнозу), валідує вхідні параметри (наприклад, назву міста або координати) та передає їх до сервісного рівня.
2.  Сервісний рівень (Business Logic): Тут зосереджена основна бізнес-логіка системи, яка реалізована переважно в модулі “src/localForecast.js”. Цей шар відповідає за генерацію або отримання даних прогнозу погоди, обробку запитів, взаємодію з кешем та можливими зовнішніми API.
3.  Рівень доступу до даних (Data Access Layer): Реалізований у модулі “src/database.js”.
Комунікація між клієнтом та сервером здійснюється через REST API у форматі JSON. Це забезпечує незалежність серверної частини від будь-якого конкретного клієнтського інтерфейсу та спрощує тестування й подальшу інтеграцію.
3.2 Бізнес-логіка серверної частини програмної системи
У рамках розробки серверної частини було реалізовано бізнес-логіку, яка забезпечує надання актуального прогнозу погоди. Ця логіка є ядром системи, що зв'язує запити клієнтів із джерелами даних та механізмами їх обробки.
Основний сценарій роботи системи полягає в отриманні прогнозу погоди для заданого сенсора. Цей процес включає декілька ключових етапів, що забезпечують ефективність та швидкість відповіді. Коли клієнт надсилає запит на ендпоінт `/forecast`, система спершу перевіряє наявність свіжого прогнозу в кеші. Якщо актуальний кешований прогноз знайдено, система негайно повертає його клієнту. В іншому випадку, сервісний шар (“src/localForecast.js”) ініціює отримання нових даних: це може бути звернення до зовнішнього погодного API або розрахунок за допомогою власної моделі. Після отримання нові дані зберігаються в кеші для майбутніх запитів і повертаються клієнту. Завдяки механізму кешування та чіткій послідовності дій, система мінімізує затримки та навантаження, забезпечуючи швидкий доступ до погодних даних.
3.3 Функції адміністрування серверної частини програмної системи
Процес взаємодії адміністратора з системою відбувається через окремі API-ендпоінти. Адміністратор може отримувати дані про всі наявні в системі сенсори, отримувати всі дані від конкретних сенсорів та видаляти сенсори, що може стати в нагоді для, наприклад, очищення сервісу від неактивних пристроїв.




________________


4 ВИСНОВКИ
У ході лабораторної роботи було розроблено бізнес-логіку та функції адміністрування для серверної частини програмної системи надання прогнозу погоди. Було реалізовано основні механізми для обробки запитів, кешування даних та взаємодії з базою даних. Також було спроектовано та описано адміністративний функціонал для управління конфігурацією системи та її моніторингу.
        
________________


5 ВИКОРИСТАНІ ДЖЕРЕЛА
1. Vision and Scope: Uk-v2. Харків: Харківський національний університет радіоелектроніки, 2024. URL: https://dl.nure.ua/pluginfile.php/1138788/mod_resource/content/1/Vision_and_Scope_uk-v2.pdf
2. IEEE Std 830-1998 — IEEE Recommended Practice for Software Requirements Specifications.
3. Express.js Official Documentation: https://expressjs.com
4. Sqlite Documentation: https://www.sqlite.org
________________
6 ДОДАТОК А
Посилання на відео: https://youtu.be/h8e7QukkiUU
________________


7 ДОДАТОК Б
Графічні матеріали
  

Рисунок Б.1 – Діаграма взаємодії (сценарій запису нових показників датчика)
  

Рисунок Б.2 – Діаграма діяльності (адміністративні дії)
  

Рисунок Б.3 – Діаграма діяльності (отримання прогнозу погоди)
  

Рисунок Б.4 – Діаграма діяльності (реєстрація нового сенсора)
  

Рисунок Б.5 – Діаграма діяльності (відправка показників на сервер)
________________
8 ДОДАТОК В
Специфікація API
/**
 * @swagger
 * /local-forecasts/{sensor_id}:
 *   get:
 *     summary: Get a local forecast for a sensor
 *     tags: [Sensors]
 *     parameters:
 *       - in: path
 *         name: sensor_id
 *         schema:
 *           type: string
 *         required: true
 *         description: The sensor id
 *       - in: query
 *         name: hours_ahead
 *         schema:
 *           type: integer
 *         description: The number of hours ahead to forecast
 *     responses:
 *       200:
 *         description: The local forecast
 *       400:
 *         description: Invalid hours_ahead parameter
 *       404:
 *         description: Not enough data to generate a local forecast
 *       500:
 *         description: Some server error
 */


/**
 * @swagger
 * /admin/sensors:
 *   get:
 *     summary: Get all registered sensors
 *     tags: [Admin]
 *     responses:
 *       200:
 *         description: A list of all sensors
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 $ref: '#/components/schemas/Sensor'
 *       500:
 *         description: Some server error
 */


/**
 * @swagger
 * /admin/sensors/{id}:
 *   delete:
 *     summary: Delete a sensor by ID
 *     tags: [Admin]
 *     parameters:
 *       - in: path
 *         name: id
 *         schema:
 *           type: string
 *         required: true
 *         description: The sensor ID
 *     responses:
 *       200:
 *         description: The sensor was successfully deleted
 *       404:
 *         description: Sensor not found
 *       500:
 *         description: Some server error
 */


/**
 * @swagger
 * /admin/sensors/{id}/readings:
 *   get:
 *     summary: Get all readings for a specific sensor
 *     tags: [Admin]
 *     parameters:
 *       - in: path
 *         name: id
 *         schema:
 *           type: string
 *         required: true
 *         description: The sensor ID
 *     responses:
 *       200:
 *         description: A list of sensor readings
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 type: object
 *                 properties:
 *                   id:
 *                     type: integer
 *                   sensor_id:
 *                     type: string
 *                   temperature:
 *                     type: number
 *                   humidity:
 *                     type: number
 *                   pressure:
 *                     type: number
 *                   created_at:
 *                     type: string
 *       404:
 *         description: Sensor not found
 *       500:
 *         description: Some server error
 */
