МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ
ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ




КАФЕДРА ПРОГРАМНОЇ ІНЖЕНЕРІЇ








Звіт
з лабораторної роботи № 4 з дисципліни
Аналіз та рефакторинг коду
за темою “Програмна система для прогнозування погоди із використанням технологій IoT, веб та мобільних клієнтів”
   










Виконав:                                                                                       Перевірив:
ст. гр. ПЗПІ-23-5                                                        ст. викладач кафедри ПІ
Біляк Данило                                                                 Сокорчук Ігор Петрович












Харків 2025
________________
2 ЗАВДАННЯ
1. Розробити будову програмного забезпечення ІоТ клієнта.
2. Створити UML діаграму прецедентів для ІоТ клієнта.
3. Розробити бізнес логіку (математину обробку повʼязаних із предметною областю даних) та функції налаштування ІоТ клієнта.
4. Створити діаграму діяльності для ІоТ клієнта.
5. Створити програмну реалізацію бізнес логіки та функцій налаштування ІоТ клієнта.
6. Перевірити роботу ІоТ клієнта.
7. Завантажити або оновити (при потребі) створений програмний код у GitHub репозиторій для лабораторних робіт у гілку репозиторію main.
8. Створити відеозапис демонстрації описаної у розділі 3.1 Vision & Scope. функціональності IoT клієнта та завантажити цей відеозапис у свій канал на YouTube. При завантаженні відеозапису потрібно обовʼязково встановити у налаштуваннях для цього відео українську мову як мову відео та мову субтитрів до відео.
9. Створити хронологічний опис (хвилина:секунда) демонстрації та додати цей опис до опису відео.
10. Створити звіт до лабораторної роботи.
11. Експортувати створений звіт у формат PDF та завантажити його на платформу dl.nure.ua.
12. Експортувати увесь створений звіт у текстовий файл з кодуванням UTF-8 та записати цей файл у GitHub репозиторій для лабораторних робіт.


________________


3 ХІД РОБОТИ
У межах лабораторної роботи було розроблено програмне забезпечення IoT-клієнта для моніторингу стану навколишнього середовища та передачі телеметричних даних на серверну частину інформаційної системи.
IoT-клієнт взаємодіє із сервером через REST API та підтримує механізми первинної реєстрації для отримання облікових даних, збереження їх у енергонезалежній памʼяті та локальну буферизацію даних на випадок збоїв передачі.
На UML діаграмі прецедентів (див. рис. Б.1) відображено основні сценарії взаємодії IoT-клієнта із зовнішніми акторами:
- IoT Пристрій;
- Сенсор;
- Бекенд API.
Основні прецеденти:
- реєстрація пристрою на сервері для отримання api-ключа;
- передавання телеметрії (температура, вологість, тиск);
- буферизація даних у разі помилки передачі;
- відправка даних із буфера;
- збереження та завантаження облікових даних пристрою.
Бізнес-логіка IoT-клієнта полягає у періодичному зчитуванні сенсорних даних, їх валідації та надійній відправці на сервер. Ключовою особливістю є механізм стійкості до збоїв мережі. Якщо пристрій не може надіслати дані, він не відкидає їх, а зберігає у локальному файлі-буфері. Перед кожною наступною відправкою нових даних клієнт спочатку намагається надіслати всі дані, що накопичилися в буфері.
Фрагмент коду, що реалізує логіку відправки та буферизації (з “src/main.cpp”):
1 if (sendReading(data.temperature, data.humidity)) {
2   Serial.println("Current reading sent successfully!");
3   // ...
4 } else {
5   Serial.println("Failed to send current reading. Appending to buffer.");
6   appendReadingToBuffer(data.temperature, data.humidity);
7 }
IoT-клієнт підтримує збереження унікальних облікових даних (sensorId та apiKey) у файловій системі LittleFS. Це забезпечує збереження ідентичності пристрою після перезавантаження та усуває необхідність повторної реєстрації.
Фрагмент коду збереження облікових даних (з `src/storage_manager.cpp`):
1 void saveSensorCredentials(const String& id, const String& key) {
2   File file = LittleFS.open(SENSOR_CREDENTIALS_FILE, "w");
3   if (file) {
4     file.println(id);
5     file.println(key);
6     file.close();
7     Serial.println("Sensor credentials saved.");
8   } else {
9     Serial.println("Failed to save sensor credentials.");
10  }
11}
Під час першого запуску пристрій перевіряє наявність облікових даних. Якщо їх немає, він автоматично запускає процес реєстрації на сервері.
На UML діаграмі діяльності (див. рис. Б.2) відображено основний алгоритм роботи пристрою. Робота починається з ініціалізації та завантаження облікових даних з енергонезалежної памʼяті. Після цього виконується підключення до мережі Wi-Fi. Якщо облікові дані відсутні, виконується первинна реєстрація на сервері. Далі IoT-клієнт переходить у основний цикл функціонування, у межах якого зчитує дані з сенсора, обробляє буфер, надсилає дані та, у разі невдачі, зберігає їх для наступної спроби.




________________


4 ВИСНОВКИ
У результаті виконання лабораторної роботи було розроблено повнофункціональний та надійний IoT-клієнт для моніторингу навколишнього середовища. Клієнт реалізує ключову бізнес-логіку, що забезпечує стійкість до мережевих збоїв через механізм буферизації даних, підтримує безпечну ідентифікацію через унікальні ключі доступу та інтегрується із серверною частиною через REST API.
________________


5 ВИКОРИСТАНІ ДЖЕРЕЛА
1. Vision and Scope: Uk-v2. Харків: Харківський національний університет радіоелектроніки, 2024. URL: https://dl.nure.ua/pluginfile.php/1138788/mod_resource/content/1/Vision_and_Scope_uk-v2.pdf
2. IEEE Std 830-1998 — IEEE Recommended Practice for Software Requirements Specifications.
3. Express.js Official Documentation: https://expressjs.com
________________
6 ДОДАТОК А
Посилання на відео: https://youtu.be/HMvyC2Bhc7I
________________


7 ДОДАТОК Б
Графічні матеріали
  

Рисунок Б.1 – UML діаграма прецедентів для ІоТ клієнта
  

Рисунок Б.2 – UML діаграма діяльності для ІоТ клієнта